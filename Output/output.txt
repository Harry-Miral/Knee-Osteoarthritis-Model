
==================== Fold 1/5 ====================


=============== Starting training fold 1 (Corrected Version) ===============
ðŸ”§ Image segmentation: Correct 2-row 5-column layout, each expert processes 128x128 region
ðŸ¤– Optimizer: AdamW (amsgrad=True), aggressive learning rate: 0.0003
ðŸ“Š Loss function: Combined loss (Focal+LabelSmooth, gamma=1.5)
ðŸ“ˆ Learning rate schedule: Super scheduler (Multi-Warmup + Cosine + Restart)
ðŸŽ¯ Validation metrics: AUC + ACC + Precision + Recall + F1
ðŸ—ï¸  Model architecture: Ultimate multi-expert network + attention + residual
ðŸŽ¨ Visualization analysis: Correct 2-row 5-column heatmap generation + feature importance analysis
Fold 1 | Epoch   1 | Loss: 0.3298 | AUC: 0.6462 | Acc: 0.6719 | Prec: 0.7019 | Rec: 0.6719 | F1: 0.6841 | LR: 0.000048 | Time: 7.0s -> ðŸŽ¯ NEW RECORD!
Fold 1 | Epoch   2 | Loss: 0.3054 | AUC: 0.7278 | Acc: 0.6875 | Prec: 0.7479 | Rec: 0.6875 | F1: 0.7060 | LR: 0.000096 | Time: 6.9s -> ðŸŽ¯ NEW RECORD!
Fold 1 | Epoch   3 | Loss: 0.2856 | AUC: 0.7416 | Acc: 0.7292 | Prec: 0.7671 | Rec: 0.7292 | F1: 0.7420 | LR: 0.000144 | Time: 6.8s -> ðŸŽ¯ NEW RECORD!
Fold 1 | Epoch   4 | Loss: 0.2578 | AUC: 0.7309 | Acc: 0.7448 | Prec: 0.7705 | Rec: 0.7448 | F1: 0.7543 | LR: 0.000192 | Time: 6.8s
Fold 1 | Epoch   5 | Loss: 0.2472 | AUC: 0.7354 | Acc: 0.6979 | Prec: 0.7427 | Rec: 0.6979 | F1: 0.7132 | LR: 0.000240 | Time: 7.3s
Fold 1 | Epoch   6 | Loss: 0.2389 | AUC: 0.7354 | Acc: 0.7135 | Prec: 0.7456 | Rec: 0.7135 | F1: 0.7254 | LR: 0.000240 | Time: 6.9s
Fold 1 | Epoch   7 | Loss: 0.2456 | AUC: 0.7482 | Acc: 0.7188 | Prec: 0.7528 | Rec: 0.7188 | F1: 0.7310 | LR: 0.000252 | Time: 6.5s -> ðŸŽ¯ NEW RECORD!
Fold 1 | Epoch   8 | Loss: 0.2253 | AUC: 0.7357 | Acc: 0.7344 | Prec: 0.7607 | Rec: 0.7344 | F1: 0.7443 | LR: 0.000264 | Time: 6.6s
Fold 1 | Epoch   9 | Loss: 0.2181 | AUC: 0.7303 | Acc: 0.7083 | Prec: 0.7340 | Rec: 0.7083 | F1: 0.7185 | LR: 0.000276 | Time: 6.4s
Fold 1 | Epoch  10 | Loss: 0.2260 | AUC: 0.7288 | Acc: 0.7240 | Prec: 0.7554 | Rec: 0.7240 | F1: 0.7354 | LR: 0.000288 | Time: 6.6s
Fold 1 | Epoch  11 | Loss: 0.2128 | AUC: 0.7328 | Acc: 0.6979 | Prec: 0.7427 | Rec: 0.6979 | F1: 0.7132 | LR: 0.000300 | Time: 6.5s
Fold 1 | Epoch  12 | Loss: 0.1941 | AUC: 0.7321 | Acc: 0.7083 | Prec: 0.7385 | Rec: 0.7083 | F1: 0.7198 | LR: 0.000300 | Time: 6.5s
Fold 1 | Epoch  13 | Loss: 0.2041 | AUC: 0.7147 | Acc: 0.6979 | Prec: 0.7287 | Rec: 0.6979 | F1: 0.7098 | LR: 0.000298 | Time: 6.7s
Fold 1 | Epoch  14 | Loss: 0.1897 | AUC: 0.7363 | Acc: 0.7396 | Prec: 0.7593 | Rec: 0.7396 | F1: 0.7475 | LR: 0.000296 | Time: 6.5s
Fold 1 | Epoch  15 | Loss: 0.1707 | AUC: 0.7420 | Acc: 0.7031 | Prec: 0.7405 | Rec: 0.7031 | F1: 0.7166 | LR: 0.000293 | Time: 6.4s
Fold 1 | Epoch  16 | Loss: 0.1753 | AUC: 0.7456 | Acc: 0.7240 | Prec: 0.7466 | Rec: 0.7240 | F1: 0.7330 | LR: 0.000289 | Time: 6.2s
Fold 1 | Epoch  17 | Loss: 0.1693 | AUC: 0.7388 | Acc: 0.7240 | Prec: 0.7509 | Rec: 0.7240 | F1: 0.7342 | LR: 0.000284 | Time: 6.6s
Fold 1 | Epoch  18 | Loss: 0.1710 | AUC: 0.7495 | Acc: 0.6979 | Prec: 0.7333 | Rec: 0.6979 | F1: 0.7111 | LR: 0.000278 | Time: 6.2s -> ðŸŽ¯ NEW RECORD!
Fold 1 | Epoch  19 | Loss: 0.1689 | AUC: 0.7542 | Acc: 0.7500 | Prec: 0.7651 | Rec: 0.7500 | F1: 0.7563 | LR: 0.000271 | Time: 6.6s -> ðŸŽ¯ NEW RECORD!
Fold 1 | Epoch  20 | Loss: 0.1366 | AUC: 0.7651 | Acc: 0.7031 | Prec: 0.7405 | Rec: 0.7031 | F1: 0.7166 | LR: 0.000264 | Time: 6.9s -> ðŸŽ¯ NEW RECORD!
Fold 1 | Epoch  21 | Loss: 0.1398 | AUC: 0.7365 | Acc: 0.7240 | Prec: 0.7423 | Rec: 0.7240 | F1: 0.7316 | LR: 0.000256 | Time: 6.9s
Fold 1 | Epoch  22 | Loss: 0.1567 | AUC: 0.7481 | Acc: 0.7292 | Prec: 0.7494 | Rec: 0.7292 | F1: 0.7374 | LR: 0.000248 | Time: 6.8s
Fold 1 | Epoch  23 | Loss: 0.1407 | AUC: 0.7500 | Acc: 0.7500 | Prec: 0.7651 | Rec: 0.7500 | F1: 0.7563 | LR: 0.000238 | Time: 7.0s
Fold 1 | Epoch  24 | Loss: 0.1462 | AUC: 0.7190 | Acc: 0.7448 | Prec: 0.7542 | Rec: 0.7448 | F1: 0.7490 | LR: 0.000228 | Time: 6.4s
Fold 1 | Epoch  25 | Loss: 0.1358 | AUC: 0.7387 | Acc: 0.7396 | Prec: 0.7511 | Rec: 0.7396 | F1: 0.7446 | LR: 0.000218 | Time: 6.5s
Fold 1 | Epoch  26 | Loss: 0.1497 | AUC: 0.7288 | Acc: 0.7240 | Prec: 0.7423 | Rec: 0.7240 | F1: 0.7316 | LR: 0.000208 | Time: 6.7s
Fold 1 | Epoch  27 | Loss: 0.1106 | AUC: 0.7616 | Acc: 0.7135 | Prec: 0.7456 | Rec: 0.7135 | F1: 0.7254 | LR: 0.000197 | Time: 6.7s
Fold 1 | Epoch  28 | Loss: 0.1206 | AUC: 0.7545 | Acc: 0.7240 | Prec: 0.7423 | Rec: 0.7240 | F1: 0.7316 | LR: 0.000185 | Time: 7.0s
Fold 1 | Epoch  29 | Loss: 0.1014 | AUC: 0.7391 | Acc: 0.7292 | Prec: 0.7452 | Rec: 0.7292 | F1: 0.7359 | LR: 0.000174 | Time: 6.5s
Fold 1 | Epoch  30 | Loss: 0.1093 | AUC: 0.7607 | Acc: 0.7396 | Prec: 0.7552 | Rec: 0.7396 | F1: 0.7461 | LR: 0.000162 | Time: 6.7s
Fold 1 | Epoch  31 | Loss: 0.1011 | AUC: 0.7532 | Acc: 0.7344 | Prec: 0.7441 | Rec: 0.7344 | F1: 0.7388 | LR: 0.000150 | Time: 6.8s
Fold 1 | Epoch  32 | Loss: 0.1181 | AUC: 0.7475 | Acc: 0.7344 | Prec: 0.7441 | Rec: 0.7344 | F1: 0.7388 | LR: 0.000139 | Time: 6.5s
Fold 1 | Epoch  33 | Loss: 0.1083 | AUC: 0.7467 | Acc: 0.7500 | Prec: 0.7574 | Rec: 0.7500 | F1: 0.7534 | LR: 0.000127 | Time: 7.3s
Fold 1 | Epoch  34 | Loss: 0.0901 | AUC: 0.7494 | Acc: 0.7396 | Prec: 0.7472 | Rec: 0.7396 | F1: 0.7431 | LR: 0.000115 | Time: 7.2s
Fold 1 | Epoch  35 | Loss: 0.1018 | AUC: 0.7481 | Acc: 0.7500 | Prec: 0.7536 | Rec: 0.7500 | F1: 0.7517 | LR: 0.000104 | Time: 6.6s
Fold 1 | Epoch  36 | Loss: 0.0867 | AUC: 0.7409 | Acc: 0.7396 | Prec: 0.7472 | Rec: 0.7396 | F1: 0.7431 | LR: 0.000093 | Time: 6.7s
Fold 1 | Epoch  37 | Loss: 0.0740 | AUC: 0.7536 | Acc: 0.7448 | Prec: 0.7542 | Rec: 0.7448 | F1: 0.7490 | LR: 0.000082 | Time: 6.7s
Fold 1 | Epoch  38 | Loss: 0.0857 | AUC: 0.7498 | Acc: 0.7500 | Prec: 0.7536 | Rec: 0.7500 | F1: 0.7517 | LR: 0.000072 | Time: 6.2s
Fold 1 | Epoch  39 | Loss: 0.1036 | AUC: 0.7554 | Acc: 0.7552 | Prec: 0.7606 | Rec: 0.7552 | F1: 0.7577 | LR: 0.000062 | Time: 6.3s
Fold 1 | Epoch  40 | Loss: 0.0765 | AUC: 0.7533 | Acc: 0.7500 | Prec: 0.7574 | Rec: 0.7500 | F1: 0.7534 | LR: 0.000053 | Time: 6.3s
Fold 1 | Epoch  41 | Loss: 0.0844 | AUC: 0.7473 | Acc: 0.7396 | Prec: 0.7472 | Rec: 0.7396 | F1: 0.7431 | LR: 0.000044 | Time: 7.0s
Fold 1 | Epoch  42 | Loss: 0.0765 | AUC: 0.7372 | Acc: 0.7396 | Prec: 0.7472 | Rec: 0.7396 | F1: 0.7431 | LR: 0.000036 | Time: 6.4s
Fold 1 | Epoch  43 | Loss: 0.0836 | AUC: 0.7371 | Acc: 0.7344 | Prec: 0.7441 | Rec: 0.7344 | F1: 0.7388 | LR: 0.000029 | Time: 6.5s
Fold 1 | Epoch  44 | Loss: 0.0734 | AUC: 0.7387 | Acc: 0.7344 | Prec: 0.7441 | Rec: 0.7344 | F1: 0.7388 | LR: 0.000023 | Time: 6.6s
Fold 1 | Epoch  45 | Loss: 0.0839 | AUC: 0.7346 | Acc: 0.7500 | Prec: 0.7536 | Rec: 0.7500 | F1: 0.7517 | LR: 0.000017 | Time: 6.6s
Fold 1 | Epoch  46 | Loss: 0.0744 | AUC: 0.7398 | Acc: 0.7448 | Prec: 0.7504 | Rec: 0.7448 | F1: 0.7474 | LR: 0.000012 | Time: 6.7s
Fold 1 | Epoch  47 | Loss: 0.0700 | AUC: 0.7394 | Acc: 0.7344 | Prec: 0.7441 | Rec: 0.7344 | F1: 0.7388 | LR: 0.000008 | Time: 6.7s
Fold 1 | Epoch  48 | Loss: 0.0761 | AUC: 0.7395 | Acc: 0.7448 | Prec: 0.7504 | Rec: 0.7448 | F1: 0.7474 | LR: 0.000005 | Time: 6.8s
Fold 1 | Epoch  49 | Loss: 0.0837 | AUC: 0.7363 | Acc: 0.7448 | Prec: 0.7504 | Rec: 0.7448 | F1: 0.7474 | LR: 0.000002 | Time: 6.6s
Fold 1 | Epoch  50 | Loss: 0.0723 | AUC: 0.7428 | Acc: 0.7396 | Prec: 0.7472 | Rec: 0.7396 | F1: 0.7431 | LR: 0.000001 | Time: 6.4s
Fold 1 | Epoch  51 | Loss: 0.0910 | AUC: 0.7128 | Acc: 0.7604 | Prec: 0.7537 | Rec: 0.7604 | F1: 0.7567 | LR: 0.000300 | Time: 6.6s
Fold 1 | Epoch  52 | Loss: 0.1054 | AUC: 0.7187 | Acc: 0.7240 | Prec: 0.7381 | Rec: 0.7240 | F1: 0.7301 | LR: 0.000300 | Time: 6.6s
Fold 1 | Epoch  53 | Loss: 0.0965 | AUC: 0.7395 | Acc: 0.7552 | Prec: 0.7643 | Rec: 0.7552 | F1: 0.7592 | LR: 0.000298 | Time: 6.2s
Fold 1 | Epoch  54 | Loss: 0.1094 | AUC: 0.7373 | Acc: 0.7188 | Prec: 0.7352 | Rec: 0.7188 | F1: 0.7258 | LR: 0.000296 | Time: 6.5s
Fold 1 | Epoch  55 | Loss: 0.0968 | AUC: 0.7501 | Acc: 0.7500 | Prec: 0.7536 | Rec: 0.7500 | F1: 0.7517 | LR: 0.000293 | Time: 6.6s
Fold 1 | Epoch  56 | Loss: 0.1068 | AUC: 0.7548 | Acc: 0.7708 | Prec: 0.7851 | Rec: 0.7708 | F1: 0.7766 | LR: 0.000289 | Time: 6.1s
Fold 1 | Epoch  57 | Loss: 0.0759 | AUC: 0.7683 | Acc: 0.7760 | Prec: 0.7882 | Rec: 0.7760 | F1: 0.7810 | LR: 0.000284 | Time: 6.7s -> ðŸŽ¯ NEW RECORD!
Fold 1 | Epoch  58 | Loss: 0.0884 | AUC: 0.7588 | Acc: 0.7708 | Prec: 0.7708 | Rec: 0.7708 | F1: 0.7708 | LR: 0.000278 | Time: 7.0s
Fold 1 | Epoch  59 | Loss: 0.0801 | AUC: 0.7511 | Acc: 0.7604 | Prec: 0.7713 | Rec: 0.7604 | F1: 0.7651 | LR: 0.000271 | Time: 6.7s
Fold 1 | Epoch  60 | Loss: 0.0723 | AUC: 0.7550 | Acc: 0.7760 | Prec: 0.7810 | Rec: 0.7760 | F1: 0.7783 | LR: 0.000264 | Time: 6.4s
Fold 1 | Epoch  61 | Loss: 0.0743 | AUC: 0.7651 | Acc: 0.7604 | Prec: 0.7751 | Rec: 0.7604 | F1: 0.7664 | LR: 0.000256 | Time: 6.4s
Fold 1 | Epoch  62 | Loss: 0.0912 | AUC: 0.7786 | Acc: 0.7865 | Prec: 0.7820 | Rec: 0.7865 | F1: 0.7840 | LR: 0.000248 | Time: 6.9s -> ðŸŽ¯ NEW RECORD!
Fold 1 | Epoch  63 | Loss: 0.0598 | AUC: 0.7812 | Acc: 0.7865 | Prec: 0.7912 | Rec: 0.7865 | F1: 0.7886 | LR: 0.000238 | Time: 6.7s -> ðŸŽ¯ NEW RECORD!
Fold 1 | Epoch  64 | Loss: 0.0821 | AUC: 0.7437 | Acc: 0.7552 | Prec: 0.7535 | Rec: 0.7552 | F1: 0.7543 | LR: 0.000228 | Time: 6.6s
Fold 1 | Epoch  65 | Loss: 0.0661 | AUC: 0.7390 | Acc: 0.7448 | Prec: 0.7542 | Rec: 0.7448 | F1: 0.7490 | LR: 0.000218 | Time: 6.7s
Fold 1 | Epoch  66 | Loss: 0.0719 | AUC: 0.7503 | Acc: 0.7656 | Prec: 0.7673 | Rec: 0.7656 | F1: 0.7665 | LR: 0.000208 | Time: 6.4s
Fold 1 | Epoch  67 | Loss: 0.0597 | AUC: 0.7789 | Acc: 0.7708 | Prec: 0.7708 | Rec: 0.7708 | F1: 0.7708 | LR: 0.000197 | Time: 7.0s
Fold 1 | Epoch  68 | Loss: 0.0594 | AUC: 0.7778 | Acc: 0.7656 | Prec: 0.7782 | Rec: 0.7656 | F1: 0.7708 | LR: 0.000185 | Time: 6.9s
Fold 1 | Epoch  69 | Loss: 0.0651 | AUC: 0.7758 | Acc: 0.7656 | Prec: 0.7708 | Rec: 0.7656 | F1: 0.7680 | LR: 0.000174 | Time: 6.5s
Fold 1 | Epoch  70 | Loss: 0.0415 | AUC: 0.7783 | Acc: 0.7552 | Prec: 0.7643 | Rec: 0.7552 | F1: 0.7592 | LR: 0.000162 | Time: 6.5s
Fold 1 | Epoch  71 | Loss: 0.0561 | AUC: 0.7752 | Acc: 0.7656 | Prec: 0.7708 | Rec: 0.7656 | F1: 0.7680 | LR: 0.000150 | Time: 6.6s
Fold 1 | Epoch  72 | Loss: 0.0625 | AUC: 0.7737 | Acc: 0.7656 | Prec: 0.7640 | Rec: 0.7656 | F1: 0.7648 | LR: 0.000139 | Time: 6.6s
Fold 1 | Epoch  73 | Loss: 0.0493 | AUC: 0.7693 | Acc: 0.7708 | Prec: 0.7676 | Rec: 0.7708 | F1: 0.7691 | LR: 0.000127 | Time: 6.5s
Fold 1 | Epoch  74 | Loss: 0.0470 | AUC: 0.7651 | Acc: 0.7604 | Prec: 0.7570 | Rec: 0.7604 | F1: 0.7586 | LR: 0.000115 | Time: 6.9s
Fold 1 | Epoch  75 | Loss: 0.0469 | AUC: 0.7696 | Acc: 0.7760 | Prec: 0.7810 | Rec: 0.7760 | F1: 0.7783 | LR: 0.000104 | Time: 6.6s
Fold 1 | Epoch  76 | Loss: 0.0508 | AUC: 0.7711 | Acc: 0.7708 | Prec: 0.7708 | Rec: 0.7708 | F1: 0.7708 | LR: 0.000093 | Time: 6.5s
Fold 1 | Epoch  77 | Loss: 0.0519 | AUC: 0.7707 | Acc: 0.7656 | Prec: 0.7640 | Rec: 0.7656 | F1: 0.7648 | LR: 0.000082 | Time: 6.9s
Fold 1 | Epoch  78 | Loss: 0.0313 | AUC: 0.7655 | Acc: 0.7604 | Prec: 0.7570 | Rec: 0.7604 | F1: 0.7586 | LR: 0.000072 | Time: 6.6s
Fold 1 | Epoch  79 | Loss: 0.0368 | AUC: 0.7663 | Acc: 0.7656 | Prec: 0.7673 | Rec: 0.7656 | F1: 0.7665 | LR: 0.000062 | Time: 6.5s
Fold 1 | Epoch  80 | Loss: 0.0389 | AUC: 0.7702 | Acc: 0.7708 | Prec: 0.7742 | Rec: 0.7708 | F1: 0.7724 | LR: 0.000053 | Time: 6.3s
Fold 1 | Epoch  81 | Loss: 0.0308 | AUC: 0.7759 | Acc: 0.7812 | Prec: 0.7782 | Rec: 0.7812 | F1: 0.7796 | LR: 0.000044 | Time: 6.4s
Fold 1 | Epoch  82 | Loss: 0.0323 | AUC: 0.7770 | Acc: 0.7708 | Prec: 0.7777 | Rec: 0.7708 | F1: 0.7739 | LR: 0.000036 | Time: 6.8s
Fold 1 | Epoch  83 | Loss: 0.0371 | AUC: 0.7784 | Acc: 0.7656 | Prec: 0.7708 | Rec: 0.7656 | F1: 0.7680 | LR: 0.000029 | Time: 6.4s
Fold 1 | Epoch  84 | Loss: 0.0353 | AUC: 0.7798 | Acc: 0.7760 | Prec: 0.7810 | Rec: 0.7760 | F1: 0.7783 | LR: 0.000023 | Time: 6.3s
Fold 1 | Epoch  85 | Loss: 0.0429 | AUC: 0.7777 | Acc: 0.7708 | Prec: 0.7742 | Rec: 0.7708 | F1: 0.7724 | LR: 0.000017 | Time: 6.7s
Fold 1 | Epoch  86 | Loss: 0.0346 | AUC: 0.7775 | Acc: 0.7760 | Prec: 0.7744 | Rec: 0.7760 | F1: 0.7752 | LR: 0.000012 | Time: 6.6s
Fold 1 | Epoch  87 | Loss: 0.0460 | AUC: 0.7705 | Acc: 0.7760 | Prec: 0.7714 | Rec: 0.7760 | F1: 0.7735 | LR: 0.000008 | Time: 6.6s
Fold 1 | Epoch  88 | Loss: 0.0308 | AUC: 0.7730 | Acc: 0.7865 | Prec: 0.7820 | Rec: 0.7865 | F1: 0.7840 | LR: 0.000005 | Time: 6.4s
Fold 1 | Epoch  89 | Loss: 0.0528 | AUC: 0.7755 | Acc: 0.7760 | Prec: 0.7777 | Rec: 0.7760 | F1: 0.7768 | LR: 0.000002 | Time: 6.6s
Fold 1 | Epoch  90 | Loss: 0.0439 | AUC: 0.7723 | Acc: 0.7760 | Prec: 0.7777 | Rec: 0.7760 | F1: 0.7768 | LR: 0.000001 | Time: 6.9s
Fold 1 | Epoch  91 | Loss: 0.0386 | AUC: 0.7638 | Acc: 0.7812 | Prec: 0.7812 | Rec: 0.7812 | F1: 0.7812 | LR: 0.000300 | Time: 6.7s
Fold 1 | Epoch  92 | Loss: 0.0450 | AUC: 0.7952 | Acc: 0.7865 | Prec: 0.7880 | Rec: 0.7865 | F1: 0.7872 | LR: 0.000300 | Time: 6.6s -> ðŸŽ¯ NEW RECORD!
Fold 1 | Epoch  93 | Loss: 0.0492 | AUC: 0.7577 | Acc: 0.8021 | Prec: 0.7993 | Rec: 0.8021 | F1: 0.8006 | LR: 0.000298 | Time: 6.5s
Fold 1 | Epoch  94 | Loss: 0.0438 | AUC: 0.7709 | Acc: 0.7708 | Prec: 0.7777 | Rec: 0.7708 | F1: 0.7739 | LR: 0.000296 | Time: 6.3s
Fold 1 | Epoch  95 | Loss: 0.0748 | AUC: 0.7861 | Acc: 0.8021 | Prec: 0.7993 | Rec: 0.8021 | F1: 0.8006 | LR: 0.000293 | Time: 6.3s
Fold 1 | Epoch  96 | Loss: 0.0423 | AUC: 0.7667 | Acc: 0.7760 | Prec: 0.7656 | Rec: 0.7760 | F1: 0.7697 | LR: 0.000289 | Time: 7.0s
Fold 1 | Epoch  97 | Loss: 0.0595 | AUC: 0.7375 | Acc: 0.7344 | Prec: 0.7564 | Rec: 0.7344 | F1: 0.7431 | LR: 0.000284 | Time: 6.4s
Fold 1 | Epoch  98 | Loss: 0.0634 | AUC: 0.7503 | Acc: 0.7708 | Prec: 0.7742 | Rec: 0.7708 | F1: 0.7724 | LR: 0.000278 | Time: 6.6s
Fold 1 | Epoch  99 | Loss: 0.0686 | AUC: 0.7483 | Acc: 0.7656 | Prec: 0.7744 | Rec: 0.7656 | F1: 0.7695 | LR: 0.000271 | Time: 6.7s
Fold 1 | Epoch 100 | Loss: 0.0623 | AUC: 0.7420 | Acc: 0.7708 | Prec: 0.7676 | Rec: 0.7708 | F1: 0.7691 | LR: 0.000264 | Time: 6.6s
Fold 1 | Epoch 101 | Loss: 0.0465 | AUC: 0.7510 | Acc: 0.7708 | Prec: 0.7676 | Rec: 0.7708 | F1: 0.7691 | LR: 0.000256 | Time: 6.4s
Fold 1 | Epoch 102 | Loss: 0.0313 | AUC: 0.7409 | Acc: 0.7656 | Prec: 0.7673 | Rec: 0.7656 | F1: 0.7665 | LR: 0.000248 | Time: 6.6s
Fold 1 | Epoch 103 | Loss: 0.0351 | AUC: 0.7463 | Acc: 0.7760 | Prec: 0.7656 | Rec: 0.7760 | F1: 0.7697 | LR: 0.000238 | Time: 6.5s
Fold 1 | Epoch 104 | Loss: 0.0483 | AUC: 0.7514 | Acc: 0.7552 | Prec: 0.7570 | Rec: 0.7552 | F1: 0.7561 | LR: 0.000228 | Time: 6.6s
Fold 1 | Epoch 105 | Loss: 0.0386 | AUC: 0.7363 | Acc: 0.7448 | Prec: 0.7430 | Rec: 0.7448 | F1: 0.7439 | LR: 0.000218 | Time: 6.3s
Fold 1 | Epoch 106 | Loss: 0.0513 | AUC: 0.7561 | Acc: 0.8021 | Prec: 0.7968 | Rec: 0.8021 | F1: 0.7990 | LR: 0.000208 | Time: 6.6s
Fold 1 | Epoch 107 | Loss: 0.0385 | AUC: 0.7545 | Acc: 0.7865 | Prec: 0.7849 | Rec: 0.7865 | F1: 0.7857 | LR: 0.000197 | Time: 6.4s
Fold 1 | Epoch 108 | Loss: 0.0431 | AUC: 0.7687 | Acc: 0.7917 | Prec: 0.7888 | Rec: 0.7917 | F1: 0.7901 | LR: 0.000185 | Time: 6.8s
Fold 1 | Epoch 109 | Loss: 0.0471 | AUC: 0.7730 | Acc: 0.7917 | Prec: 0.7835 | Rec: 0.7917 | F1: 0.7867 | LR: 0.000174 | Time: 6.7s
Fold 1 | Epoch 110 | Loss: 0.0279 | AUC: 0.7762 | Acc: 0.7969 | Prec: 0.7954 | Rec: 0.7969 | F1: 0.7961 | LR: 0.000162 | Time: 6.7s
Fold 1 | Epoch 111 | Loss: 0.0337 | AUC: 0.7685 | Acc: 0.7760 | Prec: 0.7919 | Rec: 0.7760 | F1: 0.7822 | LR: 0.000150 | Time: 6.1s
Fold 1 | Epoch 112 | Loss: 0.0352 | AUC: 0.7664 | Acc: 0.7865 | Prec: 0.7849 | Rec: 0.7865 | F1: 0.7857 | LR: 0.000139 | Time: 6.3s
Fold 1 | Epoch 113 | Loss: 0.0296 | AUC: 0.7853 | Acc: 0.8021 | Prec: 0.7993 | Rec: 0.8021 | F1: 0.8006 | LR: 0.000127 | Time: 6.5s
Fold 1 | Epoch 114 | Loss: 0.0313 | AUC: 0.7855 | Acc: 0.7917 | Prec: 0.7980 | Rec: 0.7917 | F1: 0.7945 | LR: 0.000115 | Time: 6.6s
Fold 1 | Epoch 115 | Loss: 0.0441 | AUC: 0.7815 | Acc: 0.7917 | Prec: 0.7980 | Rec: 0.7917 | F1: 0.7945 | LR: 0.000104 | Time: 7.0s
Fold 1 | Epoch 116 | Loss: 0.0245 | AUC: 0.7762 | Acc: 0.7917 | Prec: 0.7888 | Rec: 0.7917 | F1: 0.7901 | LR: 0.000093 | Time: 6.6s
Fold 1 | Epoch 117 | Loss: 0.0286 | AUC: 0.7755 | Acc: 0.8021 | Prec: 0.8050 | Rec: 0.8021 | F1: 0.8035 | LR: 0.000082 | Time: 6.1s
Fold 1 | Epoch 118 | Loss: 0.0154 | AUC: 0.7817 | Acc: 0.7865 | Prec: 0.7820 | Rec: 0.7865 | F1: 0.7840 | LR: 0.000072 | Time: 6.6s
Fold 1 | Epoch 119 | Loss: 0.0224 | AUC: 0.7718 | Acc: 0.7812 | Prec: 0.7845 | Rec: 0.7812 | F1: 0.7828 | LR: 0.000062 | Time: 6.4s
Fold 1 | Epoch 120 | Loss: 0.0285 | AUC: 0.7685 | Acc: 0.7865 | Prec: 0.7820 | Rec: 0.7865 | F1: 0.7840 | LR: 0.000053 | Time: 6.9s
Fold 1 | Epoch 121 | Loss: 0.0182 | AUC: 0.7682 | Acc: 0.7812 | Prec: 0.7878 | Rec: 0.7812 | F1: 0.7842 | LR: 0.000044 | Time: 6.5s
Fold 1 | Epoch 122 | Loss: 0.0174 | AUC: 0.7689 | Acc: 0.7760 | Prec: 0.7777 | Rec: 0.7760 | F1: 0.7768 | LR: 0.000036 | Time: 6.4s
Fold 1 | Epoch 123 | Loss: 0.0350 | AUC: 0.7739 | Acc: 0.7865 | Prec: 0.7880 | Rec: 0.7865 | F1: 0.7872 | LR: 0.000029 | Time: 6.7s
Fold 1 | Epoch 124 | Loss: 0.0062 | AUC: 0.7705 | Acc: 0.7917 | Prec: 0.7917 | Rec: 0.7917 | F1: 0.7917 | LR: 0.000023 | Time: 6.6s
Fold 1 | Epoch 125 | Loss: 0.0213 | AUC: 0.7761 | Acc: 0.7917 | Prec: 0.7917 | Rec: 0.7917 | F1: 0.7917 | LR: 0.000017 | Time: 6.3s
Fold 1 | Epoch 126 | Loss: 0.0142 | AUC: 0.7702 | Acc: 0.7917 | Prec: 0.7888 | Rec: 0.7917 | F1: 0.7901 | LR: 0.000012 | Time: 6.6s
Fold 1 | Epoch 127 | Loss: 0.0318 | AUC: 0.7727 | Acc: 0.7865 | Prec: 0.7849 | Rec: 0.7865 | F1: 0.7857 | LR: 0.000008 | Time: 6.8s
Fold 1 | Epoch 128 | Loss: 0.0255 | AUC: 0.7723 | Acc: 0.7865 | Prec: 0.7849 | Rec: 0.7865 | F1: 0.7857 | LR: 0.000005 | Time: 6.5s
Fold 1 | Epoch 129 | Loss: 0.0429 | AUC: 0.7737 | Acc: 0.7917 | Prec: 0.7917 | Rec: 0.7917 | F1: 0.7917 | LR: 0.000002 | Time: 6.8s
Fold 1 | Epoch 130 | Loss: 0.0354 | AUC: 0.7721 | Acc: 0.7969 | Prec: 0.7984 | Rec: 0.7969 | F1: 0.7976 | LR: 0.000001 | Time: 6.3s
Fold 1 | Epoch 131 | Loss: 0.0189 | AUC: 0.7687 | Acc: 0.7760 | Prec: 0.7777 | Rec: 0.7760 | F1: 0.7768 | LR: 0.000300 | Time: 6.4s
Fold 1 | Epoch 132 | Loss: 0.0356 | AUC: 0.7636 | Acc: 0.7917 | Prec: 0.7917 | Rec: 0.7917 | F1: 0.7917 | LR: 0.000300 | Time: 6.6s
Early stopping at epoch 132
ðŸŽ¨ Loading fold 1 best model weights to generate correct layout heatmaps...
ðŸŽ¨ Completed saving 8 samples with correct layout Grad-CAM heatmaps to:
   ðŸ“ 2-row 5-column expert analysis: cnn_heatmaps\fold_1_best_model_gradcam\experts_2x5_layout
   ðŸ“ 2-row 5-column concatenated heatmap: cnn_heatmaps\fold_1_best_model_gradcam\concat_heatmaps_2x5
   ðŸ“ 2-row 5-column original overlay: cnn_heatmaps\fold_1_best_model_gradcam\overlay_original_2x5

ðŸ“Š Starting fold 1 feature importance analysis...
ðŸ“Š Saved fold 1 feature importance analysis to feature_analysis\feature_importance_fold_1.csv

ðŸ“ˆ Fold 1 training completed:
â±ï¸  Total training time: 0:14:38
ðŸŽ¯ Best AUC: 0.7952 (epoch 92)
ðŸ“Š Best model metrics: Acc=0.7865, Prec=0.7880, Rec=0.7865, F1=0.7872
âš¡ Average time per epoch: 0:00:06
â±ï¸  Fold 1 time: 0:14:56 | Current average AUC: 0.7952

==================== Fold 2/5 ====================
=============== Starting training fold 2 (Corrected Version) ===============
ðŸ”§ Image segmentation: Correct 2-row 5-column layout, each expert processes 128x128 region
ðŸ¤– Optimizer: AdamW (amsgrad=True), aggressive learning rate: 0.0003
ðŸ“Š Loss function: Combined loss (Focal+LabelSmooth, gamma=1.5)
ðŸ“ˆ Learning rate schedule: Super scheduler (Multi-Warmup + Cosine + Restart)
ðŸŽ¯ Validation metrics: AUC + ACC + Precision + Recall + F1
ðŸ—ï¸  Model architecture: Ultimate multi-expert network + attention + residual
ðŸŽ¨ Visualization analysis: Correct 2-row 5-column heatmap generation + feature importance analysis
Fold 2 | Epoch   1 | Loss: 0.3364 | AUC: 0.7265 | Acc: 0.4010 | Prec: 0.7652 | Rec: 0.4010 | F1: 0.3851 | LR: 0.000048 | Time: 6.7s -> ðŸŽ¯ NEW RECORD!
Fold 2 | Epoch   2 | Loss: 0.2916 | AUC: 0.7854 | Acc: 0.6823 | Prec: 0.8143 | Rec: 0.6823 | F1: 0.7055 | LR: 0.000096 | Time: 7.2s -> ðŸŽ¯ NEW RECORD!
Fold 2 | Epoch   3 | Loss: 0.2833 | AUC: 0.7862 | Acc: 0.7292 | Prec: 0.8101 | Rec: 0.7292 | F1: 0.7479 | LR: 0.000144 | Time: 6.6s -> ðŸŽ¯ NEW RECORD!
Fold 2 | Epoch   4 | Loss: 0.2731 | AUC: 0.7954 | Acc: 0.7083 | Prec: 0.7965 | Rec: 0.7083 | F1: 0.7288 | LR: 0.000192 | Time: 6.7s -> ðŸŽ¯ NEW RECORD!
Fold 2 | Epoch   5 | Loss: 0.2575 | AUC: 0.8121 | Acc: 0.7344 | Prec: 0.7953 | Rec: 0.7344 | F1: 0.7510 | LR: 0.000240 | Time: 6.8s -> ðŸŽ¯ NEW RECORD!
Fold 2 | Epoch   6 | Loss: 0.2504 | AUC: 0.8222 | Acc: 0.7292 | Prec: 0.7827 | Rec: 0.7292 | F1: 0.7451 | LR: 0.000240 | Time: 6.7s -> ðŸŽ¯ NEW RECORD!
Fold 2 | Epoch   7 | Loss: 0.2305 | AUC: 0.8140 | Acc: 0.7135 | Prec: 0.7984 | Rec: 0.7135 | F1: 0.7335 | LR: 0.000252 | Time: 6.4s
Fold 2 | Epoch   8 | Loss: 0.2290 | AUC: 0.8108 | Acc: 0.7552 | Prec: 0.8201 | Rec: 0.7552 | F1: 0.7710 | LR: 0.000264 | Time: 6.3s
Fold 2 | Epoch   9 | Loss: 0.2234 | AUC: 0.8078 | Acc: 0.7448 | Prec: 0.8050 | Rec: 0.7448 | F1: 0.7607 | LR: 0.000276 | Time: 6.7s
Fold 2 | Epoch  10 | Loss: 0.2134 | AUC: 0.8250 | Acc: 0.7812 | Prec: 0.8211 | Rec: 0.7812 | F1: 0.7927 | LR: 0.000288 | Time: 6.8s -> ðŸŽ¯ NEW RECORD!
Fold 2 | Epoch  11 | Loss: 0.2142 | AUC: 0.7805 | Acc: 0.7083 | Prec: 0.7685 | Rec: 0.7083 | F1: 0.7262 | LR: 0.000300 | Time: 6.5s
Fold 2 | Epoch  12 | Loss: 0.1939 | AUC: 0.7790 | Acc: 0.7396 | Prec: 0.7777 | Rec: 0.7396 | F1: 0.7523 | LR: 0.000300 | Time: 6.7s
Fold 2 | Epoch  13 | Loss: 0.2045 | AUC: 0.7604 | Acc: 0.6927 | Prec: 0.7464 | Rec: 0.6927 | F1: 0.7103 | LR: 0.000298 | Time: 6.5s
Fold 2 | Epoch  14 | Loss: 0.1824 | AUC: 0.7525 | Acc: 0.7031 | Prec: 0.7663 | Rec: 0.7031 | F1: 0.7217 | LR: 0.000296 | Time: 6.7s
Fold 2 | Epoch  15 | Loss: 0.1870 | AUC: 0.7798 | Acc: 0.7448 | Prec: 0.7946 | Rec: 0.7448 | F1: 0.7594 | LR: 0.000293 | Time: 6.8s
Fold 2 | Epoch  16 | Loss: 0.1791 | AUC: 0.7820 | Acc: 0.7240 | Prec: 0.7704 | Rec: 0.7240 | F1: 0.7389 | LR: 0.000289 | Time: 6.2s
Fold 2 | Epoch  17 | Loss: 0.1847 | AUC: 0.7552 | Acc: 0.7188 | Prec: 0.7536 | Rec: 0.7188 | F1: 0.7314 | LR: 0.000284 | Time: 6.4s
Fold 2 | Epoch  18 | Loss: 0.1685 | AUC: 0.7560 | Acc: 0.7240 | Prec: 0.7608 | Rec: 0.7240 | F1: 0.7370 | LR: 0.000278 | Time: 6.7s
Fold 2 | Epoch  19 | Loss: 0.1597 | AUC: 0.7661 | Acc: 0.7396 | Prec: 0.7824 | Rec: 0.7396 | F1: 0.7533 | LR: 0.000271 | Time: 6.9s
Fold 2 | Epoch  20 | Loss: 0.1509 | AUC: 0.7436 | Acc: 0.7188 | Prec: 0.7536 | Rec: 0.7188 | F1: 0.7314 | LR: 0.000264 | Time: 6.6s
Fold 2 | Epoch  21 | Loss: 0.1484 | AUC: 0.7284 | Acc: 0.6979 | Prec: 0.7589 | Rec: 0.6979 | F1: 0.7164 | LR: 0.000256 | Time: 6.4s
Fold 2 | Epoch  22 | Loss: 0.1535 | AUC: 0.7353 | Acc: 0.6562 | Prec: 0.7254 | Rec: 0.6562 | F1: 0.6781 | LR: 0.000248 | Time: 6.3s
Fold 2 | Epoch  23 | Loss: 0.1382 | AUC: 0.7482 | Acc: 0.6875 | Prec: 0.7390 | Rec: 0.6875 | F1: 0.7049 | LR: 0.000238 | Time: 6.7s
Fold 2 | Epoch  24 | Loss: 0.1507 | AUC: 0.7442 | Acc: 0.7188 | Prec: 0.7680 | Rec: 0.7188 | F1: 0.7344 | LR: 0.000228 | Time: 6.9s
Fold 2 | Epoch  25 | Loss: 0.1245 | AUC: 0.7172 | Acc: 0.6719 | Prec: 0.7321 | Rec: 0.6719 | F1: 0.6916 | LR: 0.000218 | Time: 6.7s
Fold 2 | Epoch  26 | Loss: 0.1204 | AUC: 0.7280 | Acc: 0.7292 | Prec: 0.7543 | Rec: 0.7292 | F1: 0.7390 | LR: 0.000208 | Time: 6.6s
Fold 2 | Epoch  27 | Loss: 0.1203 | AUC: 0.7271 | Acc: 0.7396 | Prec: 0.7641 | Rec: 0.7396 | F1: 0.7490 | LR: 0.000197 | Time: 6.9s
Fold 2 | Epoch  28 | Loss: 0.1133 | AUC: 0.7217 | Acc: 0.6927 | Prec: 0.7464 | Rec: 0.6927 | F1: 0.7103 | LR: 0.000185 | Time: 6.7s
Fold 2 | Epoch  29 | Loss: 0.1012 | AUC: 0.7092 | Acc: 0.7031 | Prec: 0.7367 | Rec: 0.7031 | F1: 0.7159 | LR: 0.000174 | Time: 6.7s
Fold 2 | Epoch  30 | Loss: 0.0997 | AUC: 0.7278 | Acc: 0.7292 | Prec: 0.7728 | Rec: 0.7292 | F1: 0.7434 | LR: 0.000162 | Time: 6.7s
Fold 2 | Epoch  31 | Loss: 0.0992 | AUC: 0.7241 | Acc: 0.7135 | Prec: 0.7607 | Rec: 0.7135 | F1: 0.7291 | LR: 0.000150 | Time: 6.8s
Fold 2 | Epoch  32 | Loss: 0.1027 | AUC: 0.7205 | Acc: 0.6979 | Prec: 0.7487 | Rec: 0.6979 | F1: 0.7148 | LR: 0.000139 | Time: 6.9s
Fold 2 | Epoch  33 | Loss: 0.0958 | AUC: 0.7373 | Acc: 0.7292 | Prec: 0.7588 | Rec: 0.7292 | F1: 0.7402 | LR: 0.000127 | Time: 6.5s
Fold 2 | Epoch  34 | Loss: 0.0947 | AUC: 0.7306 | Acc: 0.7135 | Prec: 0.7464 | Rec: 0.7135 | F1: 0.7259 | LR: 0.000115 | Time: 6.5s
Fold 2 | Epoch  35 | Loss: 0.1073 | AUC: 0.7317 | Acc: 0.7240 | Prec: 0.7516 | Rec: 0.7240 | F1: 0.7346 | LR: 0.000104 | Time: 6.5s
Fold 2 | Epoch  36 | Loss: 0.0950 | AUC: 0.7339 | Acc: 0.7292 | Prec: 0.7415 | Rec: 0.7292 | F1: 0.7346 | LR: 0.000093 | Time: 6.3s
Fold 2 | Epoch  37 | Loss: 0.0909 | AUC: 0.7348 | Acc: 0.7240 | Prec: 0.7472 | Rec: 0.7240 | F1: 0.7333 | LR: 0.000082 | Time: 6.6s
Fold 2 | Epoch  38 | Loss: 0.0755 | AUC: 0.7289 | Acc: 0.7083 | Prec: 0.7347 | Rec: 0.7083 | F1: 0.7189 | LR: 0.000072 | Time: 6.6s
Fold 2 | Epoch  39 | Loss: 0.0913 | AUC: 0.7321 | Acc: 0.7083 | Prec: 0.7486 | Rec: 0.7083 | F1: 0.7226 | LR: 0.000062 | Time: 6.4s
Fold 2 | Epoch  40 | Loss: 0.0888 | AUC: 0.7403 | Acc: 0.7083 | Prec: 0.7439 | Rec: 0.7083 | F1: 0.7215 | LR: 0.000053 | Time: 6.3s
Fold 2 | Epoch  41 | Loss: 0.0974 | AUC: 0.7367 | Acc: 0.7188 | Prec: 0.7536 | Rec: 0.7188 | F1: 0.7314 | LR: 0.000044 | Time: 6.3s
Fold 2 | Epoch  42 | Loss: 0.0938 | AUC: 0.7372 | Acc: 0.7135 | Prec: 0.7464 | Rec: 0.7135 | F1: 0.7259 | LR: 0.000036 | Time: 6.4s
Fold 2 | Epoch  43 | Loss: 0.0806 | AUC: 0.7332 | Acc: 0.7448 | Prec: 0.7585 | Rec: 0.7448 | F1: 0.7507 | LR: 0.000029 | Time: 6.5s
Fold 2 | Epoch  44 | Loss: 0.0789 | AUC: 0.7308 | Acc: 0.7344 | Prec: 0.7528 | Rec: 0.7344 | F1: 0.7420 | LR: 0.000023 | Time: 7.0s
Fold 2 | Epoch  45 | Loss: 0.0854 | AUC: 0.7326 | Acc: 0.7083 | Prec: 0.7439 | Rec: 0.7083 | F1: 0.7215 | LR: 0.000017 | Time: 6.6s
Fold 2 | Epoch  46 | Loss: 0.0795 | AUC: 0.7369 | Acc: 0.7188 | Prec: 0.7536 | Rec: 0.7188 | F1: 0.7314 | LR: 0.000012 | Time: 6.7s
Fold 2 | Epoch  47 | Loss: 0.0716 | AUC: 0.7300 | Acc: 0.7240 | Prec: 0.7472 | Rec: 0.7240 | F1: 0.7333 | LR: 0.000008 | Time: 6.6s
Fold 2 | Epoch  48 | Loss: 0.0676 | AUC: 0.7315 | Acc: 0.7240 | Prec: 0.7562 | Rec: 0.7240 | F1: 0.7358 | LR: 0.000005 | Time: 6.6s
Fold 2 | Epoch  49 | Loss: 0.0924 | AUC: 0.7287 | Acc: 0.7083 | Prec: 0.7439 | Rec: 0.7083 | F1: 0.7215 | LR: 0.000002 | Time: 7.0s
Fold 2 | Epoch  50 | Loss: 0.0680 | AUC: 0.7280 | Acc: 0.7083 | Prec: 0.7486 | Rec: 0.7083 | F1: 0.7226 | LR: 0.000001 | Time: 6.7s
Early stopping at epoch 50
ðŸŽ¨ Completed saving 8 samples with correct layout Grad-CAM heatmaps to:
   ðŸ“ 2-row 5-column expert analysis: cnn_heatmaps\fold_2_best_model_gradcam\experts_2x5_layout
   ðŸ“ 2-row 5-column concatenated heatmap: cnn_heatmaps\fold_2_best_model_gradcam\concat_heatmaps_2x5
   ðŸ“ 2-row 5-column original overlay: cnn_heatmaps\fold_2_best_model_gradcam\overlay_original_2x5

ðŸ“Š Starting fold 2 feature importance analysis...
ðŸ“Š Saved fold 2 feature importance analysis to feature_analysis\feature_importance_fold_2.csv

ðŸ“ˆ Fold 2 training completed:
â±ï¸  Total training time: 0:05:36
ðŸŽ¯ Best AUC: 0.8250 (epoch 10)
ðŸ“Š Best model metrics: Acc=0.7812, Prec=0.8211, Rec=0.7812, F1=0.7927
âš¡ Average time per epoch: 0:00:06
â±ï¸  Fold 2 time: 0:05:55 | Current average AUC: 0.8101

==================== Fold 3/5 ====================
=============== Starting training fold 3 (Corrected Version) ===============
ðŸ”§ Image segmentation: Correct 2-row 5-column layout, each expert processes 128x128 region
ðŸ¤– Optimizer: AdamW (amsgrad=True), aggressive learning rate: 0.0003
ðŸ“Š Loss function: Combined loss (Focal+LabelSmooth, gamma=1.5)
ðŸ“ˆ Learning rate schedule: Super scheduler (Multi-Warmup + Cosine + Restart)
ðŸŽ¯ Validation metrics: AUC + ACC + Precision + Recall + F1
ðŸ—ï¸  Model architecture: Ultimate multi-expert network + attention + residual
ðŸŽ¨ Visualization analysis: Correct 2-row 5-column heatmap generation + feature importance analysis
Fold 3 | Epoch   1 | Loss: 0.4054 | AUC: 0.6135 | Acc: 0.5677 | Prec: 0.7041 | Rec: 0.5677 | F1: 0.5976 | LR: 0.000048 | Time: 6.7s -> ðŸŽ¯ NEW RECORD!
Fold 3 | Epoch   2 | Loss: 0.3382 | AUC: 0.7387 | Acc: 0.6927 | Prec: 0.7773 | Rec: 0.6927 | F1: 0.7133 | LR: 0.000096 | Time: 6.5s -> ðŸŽ¯ NEW RECORD!
Fold 3 | Epoch   3 | Loss: 0.2962 | AUC: 0.7708 | Acc: 0.7604 | Prec: 0.7962 | Rec: 0.7604 | F1: 0.7717 | LR: 0.000144 | Time: 6.7s -> ðŸŽ¯ NEW RECORD!
Fold 3 | Epoch   4 | Loss: 0.2665 | AUC: 0.7623 | Acc: 0.7292 | Prec: 0.7867 | Rec: 0.7292 | F1: 0.7452 | LR: 0.000192 | Time: 6.4s
Fold 3 | Epoch   5 | Loss: 0.2885 | AUC: 0.7576 | Acc: 0.7188 | Prec: 0.7719 | Rec: 0.7188 | F1: 0.7347 | LR: 0.000240 | Time: 7.0s
Fold 3 | Epoch   6 | Loss: 0.2503 | AUC: 0.7640 | Acc: 0.7240 | Prec: 0.7743 | Rec: 0.7240 | F1: 0.7392 | LR: 0.000240 | Time: 6.6s
Fold 3 | Epoch   7 | Loss: 0.2607 | AUC: 0.7626 | Acc: 0.7344 | Prec: 0.7839 | Rec: 0.7344 | F1: 0.7490 | LR: 0.000252 | Time: 6.7s
Fold 3 | Epoch   8 | Loss: 0.2346 | AUC: 0.7698 | Acc: 0.7240 | Prec: 0.7743 | Rec: 0.7240 | F1: 0.7392 | LR: 0.000264 | Time: 6.5s
Fold 3 | Epoch   9 | Loss: 0.2363 | AUC: 0.7756 | Acc: 0.7500 | Prec: 0.7865 | Rec: 0.7500 | F1: 0.7618 | LR: 0.000276 | Time: 6.9s -> ðŸŽ¯ NEW RECORD!
Fold 3 | Epoch  10 | Loss: 0.2346 | AUC: 0.7530 | Acc: 0.7188 | Prec: 0.7528 | Rec: 0.7188 | F1: 0.7310 | LR: 0.000288 | Time: 6.6s
Fold 3 | Epoch  11 | Loss: 0.2082 | AUC: 0.7375 | Acc: 0.7083 | Prec: 0.7673 | Rec: 0.7083 | F1: 0.7256 | LR: 0.000300 | Time: 6.7s
Fold 3 | Epoch  12 | Loss: 0.2151 | AUC: 0.7610 | Acc: 0.7604 | Prec: 0.7874 | Rec: 0.7604 | F1: 0.7699 | LR: 0.000300 | Time: 6.9s
Fold 3 | Epoch  13 | Loss: 0.1996 | AUC: 0.7328 | Acc: 0.6771 | Prec: 0.7434 | Rec: 0.6771 | F1: 0.6969 | LR: 0.000298 | Time: 6.6s
Fold 3 | Epoch  14 | Loss: 0.2023 | AUC: 0.7401 | Acc: 0.6719 | Prec: 0.7412 | Rec: 0.6719 | F1: 0.6923 | LR: 0.000296 | Time: 6.7s
Fold 3 | Epoch  15 | Loss: 0.1843 | AUC: 0.7726 | Acc: 0.7396 | Prec: 0.7815 | Rec: 0.7396 | F1: 0.7528 | LR: 0.000293 | Time: 7.1s
Fold 3 | Epoch  16 | Loss: 0.1731 | AUC: 0.7488 | Acc: 0.7135 | Prec: 0.7597 | Rec: 0.7135 | F1: 0.7285 | LR: 0.000289 | Time: 6.5s
Fold 3 | Epoch  17 | Loss: 0.1668 | AUC: 0.7552 | Acc: 0.7135 | Prec: 0.7696 | Rec: 0.7135 | F1: 0.7301 | LR: 0.000284 | Time: 6.2s
Fold 3 | Epoch  18 | Loss: 0.1681 | AUC: 0.7457 | Acc: 0.7083 | Prec: 0.7622 | Rec: 0.7083 | F1: 0.7248 | LR: 0.000278 | Time: 6.5s
Fold 3 | Epoch  19 | Loss: 0.1786 | AUC: 0.7618 | Acc: 0.7083 | Prec: 0.7725 | Rec: 0.7083 | F1: 0.7262 | LR: 0.000271 | Time: 6.7s
Fold 3 | Epoch  20 | Loss: 0.1620 | AUC: 0.7555 | Acc: 0.7188 | Prec: 0.7528 | Rec: 0.7188 | F1: 0.7310 | LR: 0.000264 | Time: 7.0s
Fold 3 | Epoch  21 | Loss: 0.1676 | AUC: 0.7451 | Acc: 0.7344 | Prec: 0.7651 | Rec: 0.7344 | F1: 0.7454 | LR: 0.000256 | Time: 6.7s
Fold 3 | Epoch  22 | Loss: 0.1605 | AUC: 0.7712 | Acc: 0.7083 | Prec: 0.7835 | Rec: 0.7083 | F1: 0.7273 | LR: 0.000248 | Time: 6.6s
Fold 3 | Epoch  23 | Loss: 0.1621 | AUC: 0.7491 | Acc: 0.7031 | Prec: 0.7651 | Rec: 0.7031 | F1: 0.7210 | LR: 0.000238 | Time: 6.3s
Fold 3 | Epoch  24 | Loss: 0.1372 | AUC: 0.7375 | Acc: 0.7292 | Prec: 0.7625 | Rec: 0.7292 | F1: 0.7410 | LR: 0.000228 | Time: 6.5s
Fold 3 | Epoch  25 | Loss: 0.1359 | AUC: 0.7444 | Acc: 0.7135 | Prec: 0.7646 | Rec: 0.7135 | F1: 0.7294 | LR: 0.000218 | Time: 6.7s
Fold 3 | Epoch  26 | Loss: 0.1382 | AUC: 0.7407 | Acc: 0.6771 | Prec: 0.7597 | Rec: 0.6771 | F1: 0.6985 | LR: 0.000208 | Time: 6.6s
Fold 3 | Epoch  27 | Loss: 0.1178 | AUC: 0.7426 | Acc: 0.7240 | Prec: 0.7694 | Rec: 0.7240 | F1: 0.7384 | LR: 0.000197 | Time: 6.6s
Fold 3 | Epoch  28 | Loss: 0.1150 | AUC: 0.7495 | Acc: 0.7500 | Prec: 0.7776 | Rec: 0.7500 | F1: 0.7599 | LR: 0.000185 | Time: 6.7s
Fold 3 | Epoch  29 | Loss: 0.1103 | AUC: 0.7395 | Acc: 0.7344 | Prec: 0.7743 | Rec: 0.7344 | F1: 0.7474 | LR: 0.000174 | Time: 6.9s
Fold 3 | Epoch  30 | Loss: 0.1182 | AUC: 0.7326 | Acc: 0.6875 | Prec: 0.7479 | Rec: 0.6875 | F1: 0.7060 | LR: 0.000162 | Time: 6.6s
Fold 3 | Epoch  31 | Loss: 0.1007 | AUC: 0.7312 | Acc: 0.7292 | Prec: 0.7718 | Rec: 0.7292 | F1: 0.7429 | LR: 0.000150 | Time: 6.5s
Fold 3 | Epoch  32 | Loss: 0.0908 | AUC: 0.7422 | Acc: 0.7031 | Prec: 0.7549 | Rec: 0.7031 | F1: 0.7195 | LR: 0.000139 | Time: 6.6s
Fold 3 | Epoch  33 | Loss: 0.1178 | AUC: 0.7328 | Acc: 0.7083 | Prec: 0.7573 | Rec: 0.7083 | F1: 0.7240 | LR: 0.000127 | Time: 6.7s
Fold 3 | Epoch  34 | Loss: 0.0997 | AUC: 0.7536 | Acc: 0.7292 | Prec: 0.7625 | Rec: 0.7292 | F1: 0.7410 | LR: 0.000115 | Time: 6.7s
Fold 3 | Epoch  35 | Loss: 0.1028 | AUC: 0.7501 | Acc: 0.7240 | Prec: 0.7743 | Rec: 0.7240 | F1: 0.7392 | LR: 0.000104 | Time: 6.7s
Fold 3 | Epoch  36 | Loss: 0.1071 | AUC: 0.7376 | Acc: 0.6875 | Prec: 0.7479 | Rec: 0.6875 | F1: 0.7060 | LR: 0.000093 | Time: 6.8s
Fold 3 | Epoch  37 | Loss: 0.0943 | AUC: 0.7429 | Acc: 0.7240 | Prec: 0.7599 | Rec: 0.7240 | F1: 0.7365 | LR: 0.000082 | Time: 6.4s
Fold 3 | Epoch  38 | Loss: 0.0791 | AUC: 0.7373 | Acc: 0.7031 | Prec: 0.7651 | Rec: 0.7031 | F1: 0.7210 | LR: 0.000072 | Time: 6.8s
Fold 3 | Epoch  39 | Loss: 0.0913 | AUC: 0.7472 | Acc: 0.7083 | Prec: 0.7725 | Rec: 0.7083 | F1: 0.7262 | LR: 0.000062 | Time: 6.7s
Fold 3 | Epoch  40 | Loss: 0.0830 | AUC: 0.7589 | Acc: 0.7344 | Prec: 0.7790 | Rec: 0.7344 | F1: 0.7483 | LR: 0.000053 | Time: 6.7s
Fold 3 | Epoch  41 | Loss: 0.0809 | AUC: 0.7532 | Acc: 0.7240 | Prec: 0.7743 | Rec: 0.7240 | F1: 0.7392 | LR: 0.000044 | Time: 6.8s
Fold 3 | Epoch  42 | Loss: 0.0707 | AUC: 0.7435 | Acc: 0.6927 | Prec: 0.7606 | Rec: 0.6927 | F1: 0.7119 | LR: 0.000036 | Time: 6.6s
Fold 3 | Epoch  43 | Loss: 0.0905 | AUC: 0.7461 | Acc: 0.7083 | Prec: 0.7573 | Rec: 0.7083 | F1: 0.7240 | LR: 0.000029 | Time: 6.6s
Fold 3 | Epoch  44 | Loss: 0.0808 | AUC: 0.7479 | Acc: 0.7344 | Prec: 0.7839 | Rec: 0.7344 | F1: 0.7490 | LR: 0.000023 | Time: 6.8s
Fold 3 | Epoch  45 | Loss: 0.0722 | AUC: 0.7407 | Acc: 0.7031 | Prec: 0.7599 | Rec: 0.7031 | F1: 0.7203 | LR: 0.000017 | Time: 6.6s
Fold 3 | Epoch  46 | Loss: 0.0721 | AUC: 0.7466 | Acc: 0.7292 | Prec: 0.7718 | Rec: 0.7292 | F1: 0.7429 | LR: 0.000012 | Time: 6.8s
Fold 3 | Epoch  47 | Loss: 0.0820 | AUC: 0.7420 | Acc: 0.7240 | Prec: 0.7694 | Rec: 0.7240 | F1: 0.7384 | LR: 0.000008 | Time: 6.7s
Fold 3 | Epoch  48 | Loss: 0.0709 | AUC: 0.7400 | Acc: 0.7135 | Prec: 0.7646 | Rec: 0.7135 | F1: 0.7294 | LR: 0.000005 | Time: 6.5s
Fold 3 | Epoch  49 | Loss: 0.0890 | AUC: 0.7472 | Acc: 0.7292 | Prec: 0.7718 | Rec: 0.7292 | F1: 0.7429 | LR: 0.000002 | Time: 6.5s
Early stopping at epoch 49
ðŸŽ¨ Completed saving 8 samples with correct layout Grad-CAM heatmaps to:
   ðŸ“ 2-row 5-column expert analysis: cnn_heatmaps\fold_3_best_model_gradcam\experts_2x5_layout
   ðŸ“ 2-row 5-column concatenated heatmap: cnn_heatmaps\fold_3_best_model_gradcam\concat_heatmaps_2x5
   ðŸ“ 2-row 5-column original overlay: cnn_heatmaps\fold_3_best_model_gradcam\overlay_original_2x5

ðŸ“Š Starting fold 3 feature importance analysis...
ðŸ“Š Saved fold 3 feature importance analysis to feature_analysis\feature_importance_fold_3.csv

ðŸ“ˆ Fold 3 training completed:
â±ï¸  Total training time: 0:05:31
ðŸŽ¯ Best AUC: 0.7756 (epoch 9)
ðŸ“Š Best model metrics: Acc=0.7500, Prec=0.7865, Rec=0.7500, F1=0.7618
âš¡ Average time per epoch: 0:00:06
â±ï¸  Fold 3 time: 0:05:50 | Current average AUC: 0.7986

==================== Fold 4/5 ====================
=============== Starting training fold 4 (Corrected Version) ===============
ðŸ”§ Image segmentation: Correct 2-row 5-column layout, each expert processes 128x128 region
ðŸ¤– Optimizer: AdamW (amsgrad=True), aggressive learning rate: 0.0003
ðŸ“Š Loss function: Combined loss (Focal+LabelSmooth, gamma=1.5)
ðŸ“ˆ Learning rate schedule: Super scheduler (Multi-Warmup + Cosine + Restart)
ðŸŽ¯ Validation metrics: AUC + ACC + Precision + Recall + F1
ðŸ—ï¸  Model architecture: Ultimate multi-expert network + attention + residual
ðŸŽ¨ Visualization analysis: Correct 2-row 5-column heatmap generation + feature importance analysis
Fold 4 | Epoch   1 | Loss: 0.3753 | AUC: 0.7159 | Acc: 0.7135 | Prec: 0.7374 | Rec: 0.7135 | F1: 0.7232 | LR: 0.000048 | Time: 6.9s -> ðŸŽ¯ NEW RECORD!
Fold 4 | Epoch   2 | Loss: 0.3026 | AUC: 0.7365 | Acc: 0.6615 | Prec: 0.7551 | Rec: 0.6615 | F1: 0.6854 | LR: 0.000096 | Time: 6.8s -> ðŸŽ¯ NEW RECORD!
Fold 4 | Epoch   3 | Loss: 0.2743 | AUC: 0.7135 | Acc: 0.6823 | Prec: 0.7470 | Rec: 0.6823 | F1: 0.7021 | LR: 0.000144 | Time: 6.8s
Fold 4 | Epoch   4 | Loss: 0.2710 | AUC: 0.7156 | Acc: 0.7031 | Prec: 0.7414 | Rec: 0.7031 | F1: 0.7171 | LR: 0.000192 | Time: 6.8s
Fold 4 | Epoch   5 | Loss: 0.2459 | AUC: 0.7140 | Acc: 0.7292 | Prec: 0.7332 | Rec: 0.7292 | F1: 0.7311 | LR: 0.000240 | Time: 7.0s
Fold 4 | Epoch   6 | Loss: 0.2361 | AUC: 0.6959 | Acc: 0.7344 | Prec: 0.7444 | Rec: 0.7344 | F1: 0.7389 | LR: 0.000240 | Time: 6.5s
Fold 4 | Epoch   7 | Loss: 0.2221 | AUC: 0.7082 | Acc: 0.7396 | Prec: 0.7556 | Rec: 0.7396 | F1: 0.7463 | LR: 0.000252 | Time: 6.8s
Fold 4 | Epoch   8 | Loss: 0.2108 | AUC: 0.6973 | Acc: 0.7135 | Prec: 0.7419 | Rec: 0.7135 | F1: 0.7246 | LR: 0.000264 | Time: 6.6s
Fold 4 | Epoch   9 | Loss: 0.2246 | AUC: 0.6934 | Acc: 0.6719 | Prec: 0.7373 | Rec: 0.6719 | F1: 0.6924 | LR: 0.000276 | Time: 6.8s
Fold 4 | Epoch  10 | Loss: 0.2051 | AUC: 0.6790 | Acc: 0.7031 | Prec: 0.7321 | Rec: 0.7031 | F1: 0.7146 | LR: 0.000288 | Time: 7.0s
Fold 4 | Epoch  11 | Loss: 0.2033 | AUC: 0.6900 | Acc: 0.6771 | Prec: 0.7294 | Rec: 0.6771 | F1: 0.6951 | LR: 0.000300 | Time: 6.4s
Fold 4 | Epoch  12 | Loss: 0.2015 | AUC: 0.7044 | Acc: 0.6927 | Prec: 0.7317 | Rec: 0.6927 | F1: 0.7072 | LR: 0.000300 | Time: 7.0s
Fold 4 | Epoch  13 | Loss: 0.1883 | AUC: 0.6903 | Acc: 0.7188 | Prec: 0.7357 | Rec: 0.7188 | F1: 0.7260 | LR: 0.000298 | Time: 6.5s
Fold 4 | Epoch  14 | Loss: 0.1786 | AUC: 0.6907 | Acc: 0.7188 | Prec: 0.7314 | Rec: 0.7188 | F1: 0.7244 | LR: 0.000296 | Time: 6.9s
Fold 4 | Epoch  15 | Loss: 0.1758 | AUC: 0.6973 | Acc: 0.7240 | Prec: 0.7429 | Rec: 0.7240 | F1: 0.7319 | LR: 0.000293 | Time: 6.9s
Fold 4 | Epoch  16 | Loss: 0.1609 | AUC: 0.6811 | Acc: 0.7031 | Prec: 0.7186 | Rec: 0.7031 | F1: 0.7100 | LR: 0.000289 | Time: 6.6s
Fold 4 | Epoch  17 | Loss: 0.1578 | AUC: 0.6995 | Acc: 0.6927 | Prec: 0.7317 | Rec: 0.6927 | F1: 0.7072 | LR: 0.000284 | Time: 6.7s
Fold 4 | Epoch  18 | Loss: 0.1633 | AUC: 0.7114 | Acc: 0.6719 | Prec: 0.7270 | Rec: 0.6719 | F1: 0.6907 | LR: 0.000278 | Time: 6.6s
Fold 4 | Epoch  19 | Loss: 0.1456 | AUC: 0.6873 | Acc: 0.6979 | Prec: 0.7295 | Rec: 0.6979 | F1: 0.7103 | LR: 0.000271 | Time: 6.8s
Fold 4 | Epoch  20 | Loss: 0.1374 | AUC: 0.6739 | Acc: 0.6927 | Prec: 0.7270 | Rec: 0.6927 | F1: 0.7059 | LR: 0.000264 | Time: 6.5s
Fold 4 | Epoch  21 | Loss: 0.1449 | AUC: 0.6808 | Acc: 0.7083 | Prec: 0.7302 | Rec: 0.7083 | F1: 0.7175 | LR: 0.000256 | Time: 6.4s
Fold 4 | Epoch  22 | Loss: 0.1326 | AUC: 0.6808 | Acc: 0.7396 | Prec: 0.7475 | Rec: 0.7396 | F1: 0.7432 | LR: 0.000248 | Time: 6.4s
Fold 4 | Epoch  23 | Loss: 0.1205 | AUC: 0.6962 | Acc: 0.7083 | Prec: 0.7302 | Rec: 0.7083 | F1: 0.7175 | LR: 0.000238 | Time: 6.9s
Fold 4 | Epoch  24 | Loss: 0.1320 | AUC: 0.6954 | Acc: 0.6927 | Prec: 0.7177 | Rec: 0.6927 | F1: 0.7031 | LR: 0.000228 | Time: 7.0s
Fold 4 | Epoch  25 | Loss: 0.1211 | AUC: 0.6971 | Acc: 0.7135 | Prec: 0.7329 | Rec: 0.7135 | F1: 0.7217 | LR: 0.000218 | Time: 6.8s
Fold 4 | Epoch  26 | Loss: 0.1109 | AUC: 0.6744 | Acc: 0.7031 | Prec: 0.7321 | Rec: 0.7031 | F1: 0.7146 | LR: 0.000208 | Time: 6.5s
Fold 4 | Epoch  27 | Loss: 0.1176 | AUC: 0.6846 | Acc: 0.7344 | Prec: 0.7364 | Rec: 0.7344 | F1: 0.7353 | LR: 0.000197 | Time: 6.8s
Fold 4 | Epoch  28 | Loss: 0.1106 | AUC: 0.6788 | Acc: 0.7031 | Prec: 0.7367 | Rec: 0.7031 | F1: 0.7159 | LR: 0.000185 | Time: 6.9s
Fold 4 | Epoch  29 | Loss: 0.0983 | AUC: 0.6706 | Acc: 0.7396 | Prec: 0.7475 | Rec: 0.7396 | F1: 0.7432 | LR: 0.000174 | Time: 6.8s
Fold 4 | Epoch  30 | Loss: 0.0998 | AUC: 0.6747 | Acc: 0.7240 | Prec: 0.7343 | Rec: 0.7240 | F1: 0.7287 | LR: 0.000162 | Time: 6.8s
Fold 4 | Epoch  31 | Loss: 0.1097 | AUC: 0.6714 | Acc: 0.7188 | Prec: 0.7357 | Rec: 0.7188 | F1: 0.7260 | LR: 0.000150 | Time: 6.7s
Fold 4 | Epoch  32 | Loss: 0.0751 | AUC: 0.6663 | Acc: 0.7031 | Prec: 0.7321 | Rec: 0.7031 | F1: 0.7146 | LR: 0.000139 | Time: 6.7s
Fold 4 | Epoch  33 | Loss: 0.0947 | AUC: 0.6674 | Acc: 0.6823 | Prec: 0.7220 | Rec: 0.6823 | F1: 0.6972 | LR: 0.000127 | Time: 6.9s
Fold 4 | Epoch  34 | Loss: 0.1050 | AUC: 0.6773 | Acc: 0.7031 | Prec: 0.7321 | Rec: 0.7031 | F1: 0.7146 | LR: 0.000115 | Time: 6.7s
Fold 4 | Epoch  35 | Loss: 0.0916 | AUC: 0.6644 | Acc: 0.7135 | Prec: 0.7329 | Rec: 0.7135 | F1: 0.7217 | LR: 0.000104 | Time: 6.8s
Fold 4 | Epoch  36 | Loss: 0.0759 | AUC: 0.6723 | Acc: 0.7135 | Prec: 0.7374 | Rec: 0.7135 | F1: 0.7232 | LR: 0.000093 | Time: 7.3s
Fold 4 | Epoch  37 | Loss: 0.0778 | AUC: 0.6748 | Acc: 0.6979 | Prec: 0.7295 | Rec: 0.6979 | F1: 0.7103 | LR: 0.000082 | Time: 6.8s
Fold 4 | Epoch  38 | Loss: 0.0964 | AUC: 0.6709 | Acc: 0.7240 | Prec: 0.7429 | Rec: 0.7240 | F1: 0.7319 | LR: 0.000072 | Time: 6.7s
Fold 4 | Epoch  39 | Loss: 0.0650 | AUC: 0.6650 | Acc: 0.6927 | Prec: 0.7270 | Rec: 0.6927 | F1: 0.7059 | LR: 0.000062 | Time: 6.4s
Fold 4 | Epoch  40 | Loss: 0.0673 | AUC: 0.6668 | Acc: 0.7188 | Prec: 0.7401 | Rec: 0.7188 | F1: 0.7276 | LR: 0.000053 | Time: 6.9s
Fold 4 | Epoch  41 | Loss: 0.0695 | AUC: 0.6589 | Acc: 0.7240 | Prec: 0.7386 | Rec: 0.7240 | F1: 0.7303 | LR: 0.000044 | Time: 6.7s
Fold 4 | Epoch  42 | Loss: 0.0880 | AUC: 0.6683 | Acc: 0.7188 | Prec: 0.7401 | Rec: 0.7188 | F1: 0.7276 | LR: 0.000036 | Time: 6.3s
Early stopping at epoch 42
ðŸŽ¨ Completed saving 8 samples with correct layout Grad-CAM heatmaps to:
   ðŸ“ 2-row 5-column expert analysis: cnn_heatmaps\fold_4_best_model_gradcam\experts_2x5_layout
   ðŸ“ 2-row 5-column concatenated heatmap: cnn_heatmaps\fold_4_best_model_gradcam\concat_heatmaps_2x5
   ðŸ“ 2-row 5-column original overlay: cnn_heatmaps\fold_4_best_model_gradcam\overlay_original_2x5

ðŸ“Š Starting fold 4 feature importance analysis...
ðŸ“Š Saved fold 4 feature importance analysis to feature_analysis\feature_importance_fold_4.csv

ðŸ“ˆ Fold 4 training completed:
â±ï¸  Total training time: 0:04:48
ðŸŽ¯ Best AUC: 0.7365 (epoch 2)
ðŸ“Š Best model metrics: Acc=0.6615, Prec=0.7551, Rec=0.6615, F1=0.6854
âš¡ Average time per epoch: 0:00:06
â±ï¸  Fold 4 time: 0:05:07 | Current average AUC: 0.7831

==================== Fold 5/5 ====================
=============== Starting training fold 5 (Corrected Version) ===============
ðŸ”§ Image segmentation: Correct 2-row 5-column layout, each expert processes 128x128 region
ðŸ¤– Optimizer: AdamW (amsgrad=True), aggressive learning rate: 0.0003
ðŸ“Š Loss function: Combined loss (Focal+LabelSmooth, gamma=1.5)
ðŸ“ˆ Learning rate schedule: Super scheduler (Multi-Warmup + Cosine + Restart)
ðŸŽ¯ Validation metrics: AUC + ACC + Precision + Recall + F1
ðŸ—ï¸  Model architecture: Ultimate multi-expert network + attention + residual
ðŸŽ¨ Visualization analysis: Correct 2-row 5-column heatmap generation + feature importance analysis
Fold 5 | Epoch   1 | Loss: 0.3283 | AUC: 0.6292 | Acc: 0.3229 | Prec: 0.6330 | Rec: 0.3229 | F1: 0.2842 | LR: 0.000048 | Time: 7.0s -> ðŸŽ¯ NEW RECORD!
Fold 5 | Epoch   2 | Loss: 0.3029 | AUC: 0.7130 | Acc: 0.6719 | Prec: 0.7520 | Rec: 0.6719 | F1: 0.6934 | LR: 0.000096 | Time: 7.3s -> ðŸŽ¯ NEW RECORD!
Fold 5 | Epoch   3 | Loss: 0.2979 | AUC: 0.7469 | Acc: 0.7292 | Prec: 0.7718 | Rec: 0.7292 | F1: 0.7429 | LR: 0.000144 | Time: 6.8s -> ðŸŽ¯ NEW RECORD!
Fold 5 | Epoch   4 | Loss: 0.2776 | AUC: 0.7928 | Acc: 0.7240 | Prec: 0.7793 | Rec: 0.7240 | F1: 0.7399 | LR: 0.000192 | Time: 6.8s -> ðŸŽ¯ NEW RECORD!
Fold 5 | Epoch   5 | Loss: 0.2615 | AUC: 0.8001 | Acc: 0.7552 | Prec: 0.7984 | Rec: 0.7552 | F1: 0.7680 | LR: 0.000240 | Time: 7.4s -> ðŸŽ¯ NEW RECORD!
Fold 5 | Epoch   6 | Loss: 0.2590 | AUC: 0.8088 | Acc: 0.8229 | Prec: 0.8256 | Rec: 0.8229 | F1: 0.8241 | LR: 0.000240 | Time: 6.6s -> ðŸŽ¯ NEW RECORD!
Fold 5 | Epoch   7 | Loss: 0.2629 | AUC: 0.7985 | Acc: 0.7917 | Prec: 0.8050 | Rec: 0.7917 | F1: 0.7969 | LR: 0.000252 | Time: 6.8s
Fold 5 | Epoch   8 | Loss: 0.2242 | AUC: 0.8116 | Acc: 0.8333 | Prec: 0.8386 | Rec: 0.8333 | F1: 0.8356 | LR: 0.000264 | Time: 6.4s -> ðŸŽ¯ NEW RECORD!
Fold 5 | Epoch   9 | Loss: 0.2305 | AUC: 0.7798 | Acc: 0.7552 | Prec: 0.7891 | Rec: 0.7552 | F1: 0.7663 | LR: 0.000276 | Time: 6.4s
Fold 5 | Epoch  10 | Loss: 0.2247 | AUC: 0.7727 | Acc: 0.7656 | Prec: 0.7820 | Rec: 0.7656 | F1: 0.7721 | LR: 0.000288 | Time: 6.6s
Fold 5 | Epoch  11 | Loss: 0.2070 | AUC: 0.7753 | Acc: 0.7865 | Prec: 0.7946 | Rec: 0.7865 | F1: 0.7900 | LR: 0.000300 | Time: 6.9s
Fold 5 | Epoch  12 | Loss: 0.2085 | AUC: 0.7802 | Acc: 0.7656 | Prec: 0.7944 | Rec: 0.7656 | F1: 0.7754 | LR: 0.000300 | Time: 6.7s
Fold 5 | Epoch  13 | Loss: 0.1948 | AUC: 0.7864 | Acc: 0.7708 | Prec: 0.7708 | Rec: 0.7708 | F1: 0.7708 | LR: 0.000298 | Time: 6.9s
Fold 5 | Epoch  14 | Loss: 0.1970 | AUC: 0.7717 | Acc: 0.8021 | Prec: 0.8050 | Rec: 0.8021 | F1: 0.8035 | LR: 0.000296 | Time: 6.7s
Fold 5 | Epoch  15 | Loss: 0.1912 | AUC: 0.7786 | Acc: 0.8021 | Prec: 0.8115 | Rec: 0.8021 | F1: 0.8059 | LR: 0.000293 | Time: 6.3s
Fold 5 | Epoch  16 | Loss: 0.1812 | AUC: 0.7598 | Acc: 0.7812 | Prec: 0.7950 | Rec: 0.7812 | F1: 0.7867 | LR: 0.000289 | Time: 6.8s
Fold 5 | Epoch  17 | Loss: 0.1828 | AUC: 0.7853 | Acc: 0.7708 | Prec: 0.7971 | Rec: 0.7708 | F1: 0.7799 | LR: 0.000284 | Time: 6.7s
Fold 5 | Epoch  18 | Loss: 0.1716 | AUC: 0.7849 | Acc: 0.7969 | Prec: 0.7984 | Rec: 0.7969 | F1: 0.7976 | LR: 0.000278 | Time: 6.7s
Fold 5 | Epoch  19 | Loss: 0.1563 | AUC: 0.7812 | Acc: 0.8229 | Prec: 0.8183 | Rec: 0.8229 | F1: 0.8202 | LR: 0.000271 | Time: 6.8s
Fold 5 | Epoch  20 | Loss: 0.1590 | AUC: 0.7558 | Acc: 0.7656 | Prec: 0.7901 | Rec: 0.7656 | F1: 0.7744 | LR: 0.000264 | Time: 6.4s
Fold 5 | Epoch  21 | Loss: 0.1657 | AUC: 0.7495 | Acc: 0.7031 | Prec: 0.7651 | Rec: 0.7031 | F1: 0.7210 | LR: 0.000256 | Time: 7.0s
Fold 5 | Epoch  22 | Loss: 0.1487 | AUC: 0.7683 | Acc: 0.7812 | Prec: 0.7988 | Rec: 0.7812 | F1: 0.7879 | LR: 0.000248 | Time: 6.3s
Fold 5 | Epoch  23 | Loss: 0.1493 | AUC: 0.7663 | Acc: 0.7865 | Prec: 0.7880 | Rec: 0.7865 | F1: 0.7872 | LR: 0.000238 | Time: 6.6s
Fold 5 | Epoch  24 | Loss: 0.1270 | AUC: 0.7442 | Acc: 0.7500 | Prec: 0.7865 | Rec: 0.7500 | F1: 0.7618 | LR: 0.000228 | Time: 6.3s
Fold 5 | Epoch  25 | Loss: 0.1413 | AUC: 0.7680 | Acc: 0.8177 | Prec: 0.8282 | Rec: 0.8177 | F1: 0.8218 | LR: 0.000218 | Time: 6.7s
Fold 5 | Epoch  26 | Loss: 0.1254 | AUC: 0.7657 | Acc: 0.7760 | Prec: 0.7919 | Rec: 0.7760 | F1: 0.7822 | LR: 0.000208 | Time: 6.5s
Fold 5 | Epoch  27 | Loss: 0.1155 | AUC: 0.7627 | Acc: 0.7812 | Prec: 0.7914 | Rec: 0.7812 | F1: 0.7855 | LR: 0.000197 | Time: 6.9s
Fold 5 | Epoch  28 | Loss: 0.1091 | AUC: 0.7839 | Acc: 0.8229 | Prec: 0.8316 | Rec: 0.8229 | F1: 0.8264 | LR: 0.000185 | Time: 6.4s
Fold 5 | Epoch  29 | Loss: 0.1191 | AUC: 0.7752 | Acc: 0.8125 | Prec: 0.8183 | Rec: 0.8125 | F1: 0.8150 | LR: 0.000174 | Time: 6.8s
Fold 5 | Epoch  30 | Loss: 0.1088 | AUC: 0.7842 | Acc: 0.7969 | Prec: 0.8118 | Rec: 0.7969 | F1: 0.8025 | LR: 0.000162 | Time: 6.7s
Fold 5 | Epoch  31 | Loss: 0.1095 | AUC: 0.7742 | Acc: 0.7656 | Prec: 0.7944 | Rec: 0.7656 | F1: 0.7754 | LR: 0.000150 | Time: 6.7s
Fold 5 | Epoch  32 | Loss: 0.1013 | AUC: 0.7761 | Acc: 0.7969 | Prec: 0.8118 | Rec: 0.7969 | F1: 0.8025 | LR: 0.000139 | Time: 6.3s
Fold 5 | Epoch  33 | Loss: 0.0953 | AUC: 0.7696 | Acc: 0.7917 | Prec: 0.8050 | Rec: 0.7917 | F1: 0.7969 | LR: 0.000127 | Time: 6.9s
Fold 5 | Epoch  34 | Loss: 0.1020 | AUC: 0.7743 | Acc: 0.8021 | Prec: 0.8115 | Rec: 0.8021 | F1: 0.8059 | LR: 0.000115 | Time: 6.9s
Fold 5 | Epoch  35 | Loss: 0.1049 | AUC: 0.7749 | Acc: 0.7969 | Prec: 0.8015 | Rec: 0.7969 | F1: 0.7990 | LR: 0.000104 | Time: 6.4s
Fold 5 | Epoch  36 | Loss: 0.0951 | AUC: 0.7702 | Acc: 0.7865 | Prec: 0.7946 | Rec: 0.7865 | F1: 0.7900 | LR: 0.000093 | Time: 7.0s
Fold 5 | Epoch  37 | Loss: 0.0768 | AUC: 0.7698 | Acc: 0.7656 | Prec: 0.7782 | Rec: 0.7656 | F1: 0.7708 | LR: 0.000082 | Time: 6.3s
Fold 5 | Epoch  38 | Loss: 0.1012 | AUC: 0.7698 | Acc: 0.7552 | Prec: 0.7803 | Rec: 0.7552 | F1: 0.7643 | LR: 0.000072 | Time: 6.9s
Fold 5 | Epoch  39 | Loss: 0.0830 | AUC: 0.7664 | Acc: 0.7760 | Prec: 0.7882 | Rec: 0.7760 | F1: 0.7810 | LR: 0.000062 | Time: 6.6s
Fold 5 | Epoch  40 | Loss: 0.0830 | AUC: 0.7753 | Acc: 0.7708 | Prec: 0.7851 | Rec: 0.7708 | F1: 0.7766 | LR: 0.000053 | Time: 7.0s
Fold 5 | Epoch  41 | Loss: 0.0741 | AUC: 0.7730 | Acc: 0.7708 | Prec: 0.7851 | Rec: 0.7708 | F1: 0.7766 | LR: 0.000044 | Time: 6.7s
Fold 5 | Epoch  42 | Loss: 0.0875 | AUC: 0.7705 | Acc: 0.7865 | Prec: 0.8019 | Rec: 0.7865 | F1: 0.7924 | LR: 0.000036 | Time: 6.3s
Fold 5 | Epoch  43 | Loss: 0.0900 | AUC: 0.7748 | Acc: 0.7760 | Prec: 0.7882 | Rec: 0.7760 | F1: 0.7810 | LR: 0.000029 | Time: 6.8s
Fold 5 | Epoch  44 | Loss: 0.0864 | AUC: 0.7748 | Acc: 0.7969 | Prec: 0.8015 | Rec: 0.7969 | F1: 0.7990 | LR: 0.000023 | Time: 6.9s
Fold 5 | Epoch  45 | Loss: 0.0799 | AUC: 0.7708 | Acc: 0.7812 | Prec: 0.7914 | Rec: 0.7812 | F1: 0.7855 | LR: 0.000017 | Time: 6.5s
Fold 5 | Epoch  46 | Loss: 0.0778 | AUC: 0.7686 | Acc: 0.7656 | Prec: 0.7820 | Rec: 0.7656 | F1: 0.7721 | LR: 0.000012 | Time: 6.7s
Fold 5 | Epoch  47 | Loss: 0.0739 | AUC: 0.7651 | Acc: 0.7604 | Prec: 0.7791 | Rec: 0.7604 | F1: 0.7677 | LR: 0.000008 | Time: 6.6s
Fold 5 | Epoch  48 | Loss: 0.0824 | AUC: 0.7721 | Acc: 0.7760 | Prec: 0.7919 | Rec: 0.7760 | F1: 0.7822 | LR: 0.000005 | Time: 6.4s
Early stopping at epoch 48
ðŸŽ¨ Completed saving 8 samples with correct layout Grad-CAM heatmaps to:
   ðŸ“ 2-row 5-column expert analysis: cnn_heatmaps\fold_5_best_model_gradcam\experts_2x5_layout
   ðŸ“ 2-row 5-column concatenated heatmap: cnn_heatmaps\fold_5_best_model_gradcam\concat_heatmaps_2x5
   ðŸ“ 2-row 5-column original overlay: cnn_heatmaps\fold_5_best_model_gradcam\overlay_original_2x5

ðŸ“Š Starting fold 5 feature importance analysis...
ðŸ“Š Saved fold 5 feature importance analysis to feature_analysis\feature_importance_fold_5.csv

ðŸ“ˆ Fold 5 training completed:
â±ï¸  Total training time: 0:05:26
ðŸŽ¯ Best AUC: 0.8116 (epoch 8)
ðŸ“Š Best model metrics: Acc=0.8333, Prec=0.8386, Rec=0.8333, F1=0.8356
âš¡ Average time per epoch: 0:00:06
â±ï¸  Fold 5 time: 0:05:45 | Current average AUC: 0.7888

============================================================
ðŸŽ¯ Ultimate Results (Corrected Version - Correct 2-row 5-column Image Segmentation):
ðŸ“Š Each fold AUC scores: ['0.7952', '0.8250', '0.7756', '0.7365', '0.8116']
ðŸ“ˆ Average AUC: 0.7888 Â± 0.0309
ðŸ† Best AUC: 0.8250
â±ï¸  Total training time: 0:37:36
âš¡ Average time per fold: 0:07:31
âŒ AUC below target: < 0.80

ðŸ“Š Feature importance summary across folds:

ðŸ” Fold 1 Top 5 Important Features:
  1. side: Label corr=0.4535, Pred corr=0.6300
  2. lesion_label_9: Label corr=-0.3900, Pred corr=-0.4744
  3. V00SMKNOW: Label corr=0.2450, Pred corr=0.1787
  4. V00CESD5: Label corr=0.2037, Pred corr=-0.0130
  5. lesion_label_6: Label corr=0.1911, Pred corr=0.3916

ðŸ” Fold 2 Top 5 Important Features:
  1. side: Label corr=0.4735, Pred corr=0.7713
  2. lesion_label_9: Label corr=-0.3595, Pred corr=-0.6175
  3. lesion_label_6: Label corr=0.3556, Pred corr=0.5838
  4. lesion_label_3: Label corr=-0.1869, Pred corr=-0.2960
  5. lesion_label_10: Label corr=-0.1605, Pred corr=-0.4803

ðŸ” Fold 3 Top 5 Important Features:
  1. side: Label corr=0.5224, Pred corr=0.7139
  2. lesion_label_6: Label corr=0.4218, Pred corr=0.5292
  3. lesion_label_9: Label corr=-0.3525, Pred corr=-0.6439
  4. lesion_label_3: Label corr=-0.2728, Pred corr=-0.2159
  5. lesion_label_10: Label corr=-0.2125, Pred corr=-0.3125

ðŸ” Fold 4 Top 5 Important Features:
  1. side: Label corr=0.3217, Pred corr=0.7506
  2. lesion_label_9: Label corr=-0.2759, Pred corr=-0.6741
  3. lesion_label_6: Label corr=0.2272, Pred corr=0.6312
  4. lesion_label_10: Label corr=-0.2151, Pred corr=-0.3555
  5. P02RACE: Label corr=-0.1628, Pred corr=-0.1290

ðŸ” Fold 5 Top 5 Important Features:
  1. side: Label corr=0.4647, Pred corr=0.8202
  2. lesion_label_9: Label corr=-0.3741, Pred corr=-0.6687
  3. lesion_label_6: Label corr=0.3167, Pred corr=0.6446
  4. lesion_label_10: Label corr=-0.2736, Pred corr=-0.3764
  5. V00WOMADLR: Label corr=0.1599, Pred corr=0.1110

ðŸš€ Corrected version training completed! Correct 2-row 5-column image segmentation architecture results:
ðŸ”§ Core fix: Image segmentation logic perfectly corresponds with original 2-row 5-column concatenation!
ðŸ”¬ 10 enhanced CNN experts, each processing corresponding 128x128 knee region!
ðŸ§  Deep structured feature encoder provides 128-dim knowledge vector!
ðŸŽ¯ Combined loss + super learning rate scheduler significantly improves performance!
ðŸ¤ Ultimate regularization strategy + label smoothing + aggressive data augmentation!
ðŸŽ¨ Correct 2-row 5-column knee X-ray Grad-CAM heatmap visualization + feature importance analysis!
ðŸ” Heatmaps perfectly match original concatenation layout, each expert corresponds to correct knee region!

ðŸ“Š Results saved to final_corrected_ultra_optimized_results.pth
ðŸŽ¨ Correct 2-row 5-column knee X-ray Grad-CAM heatmaps saved to cnn_heatmaps folder
ðŸ“ˆ Feature analysis saved to feature_analysis folder
ðŸ“… Training completion time: 2025-06-28 17:27:55

ðŸ” Corrected heatmap file structure description:
   ðŸ“ cnn_heatmaps/
      â”œâ”€â”€ fold_X_best_model_gradcam/
      â”‚   â”œâ”€â”€ experts_2x5_layout/      # Correct 2-row 5-column expert analysis
      â”‚   â”œâ”€â”€ concat_heatmaps_2x5/     # Correct 2-row 5-column concatenated heatmap
      â”‚   â””â”€â”€ overlay_original_2x5/    # Correct 2-row 5-column original overlay
      â””â”€â”€ fold_X_best_model_attention/ (backup solution)

ðŸ“ Correction description:
   âœ… Expert 0-4 correspond to row 1, 5 regions (top-left to top-right)
   âœ… Expert 5-9 correspond to row 2, 5 regions (bottom-left to bottom-right)
   âœ… Heatmaps perfectly match original knee image concatenation layout
   âœ… Each expert processes correctly corresponding knee anatomical region
   ðŸ”´ Red highlighted areas = most important regions for KL grading diagnosis

Process finished with exit code 0